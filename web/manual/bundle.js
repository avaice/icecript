(()=>{"use strict";var e={168:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.functions=void 0;const i=r(24),n=r(253),o=r(397),s=r(437);t.functions={print:n.print,random:o.random,parse:i.parse,split:s.split}},571:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.inputForBrowser=void 0,t.inputForBrowser=e=>{var t;return null!==(t=window.prompt(e))&&void 0!==t?t:""}},675:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.listenWebEvent=void 0;const i=r(594);t.listenWebEvent=(e,t,r)=>{const n=document.querySelector(e);return!!n&&n.addEventListener(t,(()=>{(0,i.exec)(void 0,["event",r])}))}},361:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.movePage=void 0,t.movePage=e=>{if(e&&!e.match(/^[a-zA-Z0-9_]+$/))return!1;const t=new URL(window.location.href),r=new URLSearchParams(t.search);e&&r.set("id",e);const i=e?`?${r.toString()}`:"";history.pushState(null,"",i)}},934:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setTitle=void 0,t.setTitle=e=>{e||(e=document.getElementsByTagName("h1")[0].innerText),document.title=e}},276:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.writeHtml=void 0;const i=r(594);t.writeHtml=(e,t)=>{const r=document.querySelector(e);if(!r)return;r.innerHTML=t;const n=r.getElementsByTagName("a");for(const e of n){const t=e.href;if(""!==t){const r=new URL(t),n=new URLSearchParams(r.search).get("id");t.includes(location.href.split("?")[0])&&n&&e.addEventListener("click",(e=>{e.preventDefault(),(0,i.exec)(void 0,["render",n,!1])}))}}}},24:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;const i=r(594);t.parse=(e,t)=>"int"===e?parseInt(t):"float"===e?parseFloat(t):"number"===e?Number(t):"string"===e?t.toString():void(0,i.err)(`${e}には変換できません`)},253:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.print=void 0;const i=r(594);t.print=(e,...t)=>{(0,i.getInterceptForTest)()?(0,i.printInterceptor)(e,...t):console.log(e,...t)}},397:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.random=void 0,t.random=e=>Math.floor(Math.random()*e)},153:function(e,t){var r=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function c(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.readTextForBrowser=void 0,t.readTextForBrowser=e=>r(void 0,void 0,void 0,(function*(){return yield fetch(e).then((e=>e.text()))}))},437:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.split=void 0,t.split=(e,t)=>e.split(t)},565:function(e,t,r){var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function c(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.interpriter=t.getPointer=void 0;const n=r(168),o=r(594);let s={},c={},l=0;t.getPointer=()=>l;const d=["==","&&",">","<","!=","||"],a=["true","false","monkey","void","flag"],u=Symbol("break");t.interpriter=(e,t="initial")=>i(void 0,void 0,void 0,(function*(){s={},c={},l=0;const r=c=>i(void 0,void 0,void 0,(function*(){for(var i;l<e.length;){const P=e[l];if(n.functions.hasOwnProperty(P))return yield f(P,c.scopedVariables);if("function"===(null===(i=s[P])||void 0===i?void 0:i.type))return yield y();if("var"===P)return yield v(c.scopedVariables);if("("===P)return yield m(c.scopedVariables);if("["===P)return yield g(c.scopedVariables);if("if"===P)return yield V({scopedVariables:c.scopedVariables});if("fn"===P)return c.scopedVariables&&(0,o.err)("関数内で関数を宣言することはできません！"),yield p();if("while"===P)return yield _({scopedVariables:c.scopedVariables});if(a.includes(P))switch(P){case"true":return!0;case"false":return!1;case"monkey":return Math.random()>.5;case"flag":return t;default:return(0,o.err)("System Error! 存在しない予約語")}if(!(null==c?void 0:c.exprFlag)&&d.includes(e[l+1]))return yield x({scopedVariables:c.scopedVariables});if(!(null==c?void 0:c.exprFlag)&&["+","*","/"].includes(e[l+1]))return yield h({scopedVariables:c.scopedVariables});if("="===e[l+1])return yield b(c.scopedVariables);if(c.scopedVariables&&Object.keys(c.scopedVariables).includes(e[l]))return yield w(!0,c.scopedVariables);if(Object.keys(s).includes(e[l]))return yield w(!1,c.scopedVariables);if(P.match(/".*"/)||P.match(/`([^`]+)`/))return P.slice(1,P.length-1);if(P.match(/^[0-9]?.?[0-9]/))return Number(P);if("}"===P||"]"===P)return;if("return"===P)return"void"===e[l+1]?{sym:u,value:void 0}:(l++,{sym:u,value:yield r({scopedVariables:c.scopedVariables})});if(![",","(",")",";","void"].includes(P)&&!P.startsWith("//"))return(0,o.err)(`${P}は定義されていない命令です！`);l++}})),f=(t,s)=>i(void 0,void 0,void 0,(function*(){l++,"("!==e[l]&&(0,o.err)('関数の始めに "(" がありません'),l++;const i=[];for(;l<e.length&&")"!==e[l];){const e=yield r({scopedVariables:s});void 0!==e&&i.push(e),l++}")"!==e[l]&&(0,o.err)('関数の終わりに ")" がありません');const c=yield n.functions[t](...i);return["+","*","/"].includes(e[l+1])?yield h({leftArg:c,scopedVariables:s}):d.includes(e[l+1])?yield x({leftArg:c,scopedVariables:s}):c})),v=t=>i(void 0,void 0,void 0,(function*(){l++,a.includes(e[l])&&(0,o.err)(`"${e[l]}" はシステムの予約語なので、変数には使えません`),t?(Object.keys(t).includes(e[l])&&(0,o.err)(`宣言済みの変数 "${e[l]}" を再宣言することはできません`),t[e[l]]=void 0):(Object.keys(s).includes(e[l])&&(0,o.err)(`宣言済みの変数 "${e[l]}" を再宣言することはできません`),s[e[l]]=void 0),"="!==e[l+1]&&l++})),p=()=>i(void 0,void 0,void 0,(function*(){l++,(Object.keys(s).includes(e[l])||n.functions.hasOwnProperty(e[l]))&&(0,o.err)(`宣言済みの変数 "${e[l]}" を再宣言することはできません`),a.includes(e[l])&&(0,o.err)(`"${e[l]}" はシステムの予約語なので、変数には使えません`);const t=e[l];for(s[t]={type:"function",args:[],pointer:null},l++,"("!==e[l]&&(0,o.err)("関数の引数宣言がありません"),l++;")"!==e[l];)","!==e[l]&&s[t].args.push(e[l]),l++;l++,s[t].pointer=l,P(!1,void 0)})),y=()=>i(void 0,void 0,void 0,(function*(){const t=e[l],i=Symbol(t);c[i]={};const n=c[i];l++,"("!==e[l]&&(0,o.err)("関数の引数宣言がありません");let d=0;for(l++;")"!==e[l];)","!==e[l]&&(n[s[t].args[d]]=yield r({scopedVariables:void 0}),d++),l++;const a=l;l=s[t].pointer;const u=yield P(!0,n);return l=a,delete c[i],null==u?void 0:u.value})),b=t=>i(void 0,void 0,void 0,(function*(){const i=l;l+=2;const n=yield r({scopedVariables:t});t&&Object.keys(t).includes(e[i])?t[e[i]]=n:s[e[i]]=n,l++})),h=({leftArg:t,scopedVariables:n})=>i(void 0,void 0,void 0,(function*(){const i=e[l+1],o=null!=t?t:yield r({exprFlag:!0,scopedVariables:n});l+=2;const s=yield r({scopedVariables:n});switch(i){case"+":return o+s;case"*":return o*s;case"/":return o/s}})),m=t=>i(void 0,void 0,void 0,(function*(){l++;const i=yield r({scopedVariables:t});return l++,["+","*","/"].includes(e[l+1])?yield h({leftArg:i,scopedVariables:t}):d.includes(e[l+1])?yield x({leftArg:i,scopedVariables:t}):i})),g=t=>i(void 0,void 0,void 0,(function*(){const i=[];for(l++;"]"!==e[l];){if(","!==e[l]){const e=yield r({scopedVariables:t});i.push(e)}l++}return i})),w=(t,n)=>i(void 0,void 0,void 0,(function*(){const i=t?n[e[l]]:s[e[l]];if(Array.isArray(i)&&"["===e[l+1]){l+=2;const t=yield r({scopedVariables:n});isNaN(t)&&(console.log(typeof t),(0,o.err)("配列のインデックスに数値ではないものが指定されました！"+t)),l++;const s=i[Number(t)];return["+","*","/"].includes(e[l+1])?yield h({leftArg:s,scopedVariables:n}):d.includes(e[l+1])?yield x({leftArg:s,scopedVariables:n}):s}return i})),V=({current:t,scopedVariables:n})=>i(void 0,void 0,void 0,(function*(){l++;const i=yield r({scopedVariables:n}),o=!t&&i;l++;const s=yield P(o,n);return"else"===e[l]?(l++,yield P(!t&&!o,n)):"elif"===e[l]?yield V({current:!!t||o,scopedVariables:n}):s})),_=e=>i(void 0,void 0,void 0,(function*(){const t=l;l++;const i=!!(yield r({scopedVariables:e}));l++;const n=yield P(i,e);return i&&!n?(l=t,yield _({scopedVariables:e})):n})),x=({leftArg:t,scopedVariables:n})=>i(void 0,void 0,void 0,(function*(){const i=e[l+1],o=null!=t?t:yield r({exprFlag:!0,scopedVariables:n});l+=2;const s=yield r({scopedVariables:n});switch(i){case"==":return o==s;case"&&":return o&&s;case"||":return!(!o&&!s);case"<":return o<s;case">":return o>s;case"!=":return o!=s}})),P=(t,n)=>i(void 0,void 0,void 0,(function*(){let i,o=0;for(;l<e.length;){if("{"===e[l])o++;else if("}"===e[l]){if(o--,0===o)break}else if(t&&!i){const e=yield r({scopedVariables:n});(null==e?void 0:e.sym)===u&&(i=e),l--}l++}return l++,i}));for(;l<e.length;)yield r({scopedVariables:void 0});"node"===o.enviroment&&console.log(s)}))},291:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tokenize=void 0,t.tokenize=e=>{const t=e.split(new RegExp(`(${/`[^`]+`|""|".[^"]*"| |\n|;|\/\/.*|{|}|\[|\]/.source}|${/==|&&|\|\||!=|[<>+*/=()]/.source})`)).map((e=>null==e?void 0:e.trim())).filter((e=>e&&!e.startsWith("//"))),r={start:["(","["],end:[")","]"]};for(let e=0;e<t.length;e++)if(["*","/","==","!=","<",">"].includes(t[e])){if(r.end.includes(t[e-1])){let i=e-2,n=0;for(;i>=-1;i--)if(r.end.includes(t[i])&&n++,r.start.includes(t[i])&&(n--,-1===n)){t[i-1].match(/^[a-zA-Z0-9]+$/)?["if","elif","for","while"].includes(t[i-1])||t.splice(i-1,0,"("):t.splice(i,0,"(");break}}else t.splice(e-1,0,"(");if(e+=1,r.start.includes(t[e-1])){let r=e+2,i=0;for(;r<t.length;r++)if("("===t[r]&&i++,")"===t[r]&&(i--,-1===i)){t.splice(r,0,")");break}}else t.splice(e+2,0,")");e+=1}return t}},594:function(e,t,r){var i=this&&this.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function c(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,c)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.exec=t.err=t.enviroment=t.printInterceptor=t.setInterceptForTest=t.getInterceptForTest=t.clearInterceptResult=t.getInterceptResult=void 0;const n=r(565),o=r(291);let s,c="",l=!1,d="";t.getInterceptResult=()=>d,t.clearInterceptResult=()=>d="",t.getInterceptForTest=()=>l,t.setInterceptForTest=e=>l=e,t.printInterceptor=(e,...t)=>{d=d+[e,...t].join(" ")+"\n"},t.enviroment="undefined"==typeof window?"node":"browser",t.err=e=>{const r=(0,n.getPointer)(),i=s.slice(Math.max(0,r-5),r+5).join(" ");throw"browser"===t.enviroment?(alert(`Error: ${r}\n      該当コード近辺: ${i}\n      ${e}`),new Error(e)):new Error(`[31m${e}\n${r}: ${i}[0m`)},t.exec=(e,t)=>i(void 0,void 0,void 0,(function*(){e?c=e:e=c,s=(0,o.tokenize)(e),yield(0,n.interpriter)(s,t)}))}},t={};function r(i){var n=t[i];if(void 0!==n)return n.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,r),o.exports}(()=>{const e=r(168),t=r(571),i=r(675),n=r(361),o=r(934),s=r(276),c=r(153),l=r(594);e.functions.input=t.inputForBrowser,e.functions.writeHtml=s.writeHtml,e.functions.movePage=n.movePage,e.functions.setTitle=o.setTitle,e.functions.listenWebEvent=i.listenWebEvent,e.functions.readText=c.readTextForBrowser,window.icecript=l.exec})()})();